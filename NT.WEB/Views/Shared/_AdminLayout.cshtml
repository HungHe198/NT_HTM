@{
    Layout = null;
}
@* PSEUDOCODE / PLAN:
   - Replace hardcoded href attributes with Razor tag-helper attributes (asp-controller, asp-action).
   - For each anchor currently using a path like "/X/Y" map to asp-controller="X" and asp-action="Y".
   - Preserve classes, icons and texts.
   - Keep the first link marked as active; other links remain non-active (you can add logic later to set active dynamically).
   - Ensure tag helpers are used so routing will generate correct URLs based on routing configuration.
*@

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Admin Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <style>
        html, body {
            height: 100%;
        }

        body {
            background: #f9fafb;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .sidebar {
            min-width: 220px;
            background: #fff;
            height: 100vh;
        }
        .sidebar.collapsed { width: 64px; min-width:64px; }
        .sidebar.collapsed .nav-link span { display:none; }
        .sidebar.collapsed .nav-link i { margin-right:0; text-align:center; width:100%; }

            .sidebar .nav-link.active {
                background: #f4f6fb;
                color: #1976d2;
            }

            .sidebar .nav-link {
                color: #637381;
            }

                .sidebar .nav-link:hover {
                    background: #eef3fb;
                    color: #1976d2;
                }

                .sidebar .nav-link i {
                    margin-right: 10px;
                }

        .content {
            padding: 2rem;
        }

        .topbar {
            background: #fff;
            padding: 1rem 2rem;
            border-bottom: 1px solid #f0f0f0;
        }

        /* Hero */
        .admin-hero .hero-inner{
            display:flex;align-items:center;justify-content:space-between;padding:2rem;background:linear-gradient(90deg,#667eea,#764ba2);color:white;border-radius:10px;box-shadow:0 6px 24px rgba(102,126,234,0.16);
        }
        .hero-title{font-size:2.25rem;margin:0 0 .25rem}
        .hero-sub{opacity:0.9;margin:0}

        .stat-card{background:#fff;border-radius:8px;box-shadow:0 6px 18px rgba(11,20,35,0.04);min-height:100px}
        .stat-label{font-size:.85rem;color:#6c7a89;font-weight:700}
        .stat-value{font-size:1.6rem;font-weight:700;margin-top:.5rem}
        .stat-note{font-size:.85rem}

        .quick-actions{background:linear-gradient(90deg,#667eea,#764ba2);color:white;border-radius:10px;box-shadow:0 8px 30px rgba(118,75,162,0.12)}
        .quick-actions h6{margin:0}
        .btn-action{background:white;color:#333;border-radius:8px}

        main.content {
            flex: 1 0 auto;
        }
    </style>
</head>
<body>
    @{
        var currentController = (ViewContext.RouteData.Values["controller"] as string) ?? string.Empty;
        var currentAction = (ViewContext.RouteData.Values["action"] as string) ?? string.Empty;
        Func<string, string?, string> isActive = (controller, action) =>
        string.Equals(currentController, controller, StringComparison.OrdinalIgnoreCase) &&
        (string.IsNullOrEmpty(action) || string.Equals(currentAction, action, StringComparison.OrdinalIgnoreCase))
        ? "active" : string.Empty;
    }
    <div class="d-flex flex-grow-1">
        <!-- Sidebar -->
        <nav id="adminSidebar" class="sidebar d-flex flex-column p-3">
            <button id="sidebarToggle" class="btn btn-sm btn-outline-secondary mb-3" title="Thu gọn menu">
                <i class="fa fa-bars"></i>
            </button>
            
            <ul class="nav nav-pills flex-column mb-auto">
                <li>
                    <a asp-controller="Admin" asp-action="Index" class="nav-link @isActive("Admin", "Index")">
                        <i class="fa fa-tachometer-alt"></i>
                        <span class="ms-1">Bảng Điều Khiển</span>
                    </a>
                </li>
                <li><a asp-controller="RevenueStatistics" asp-action="Index" class="nav-link @isActive("RevenueStatistics", "Index")"><i class="fa fa-chart-bar"></i><span class="ms-1">Thống kê doanh thu</span></a></li>
                <li><a asp-controller="UserManagement" asp-action="Index" class="nav-link @isActive("UserManagement", "Index")"><i class="fa fa-users-cog"></i><span class="ms-1">Quản lý tài khoản</span></a></li>
                <li><a asp-controller="RolePermission" asp-action="Index" class="nav-link @isActive("RolePermission", "Index")"><i class="fa fa-user-shield"></i><span class="ms-1">Phân quyền</span></a></li>
                @* <li><a asp-controller="Customer" asp-action="Index" class="nav-link @isActive("Customer", "Index")"><i class="fa fa-users"></i>Khách hàng</a></li> *@
                <li><a asp-controller="Product" asp-action="Index" class="nav-link @isActive("Product", "Index")"><i class="fa fa-box"></i><span class="ms-1">Sản phẩm</span></a></li>
                <li><a asp-controller="ProductCategory" asp-action="Index" class="nav-link @isActive("ProductCategory", "Index")"><i class="fa fa-list"></i><span class="ms-1">Danh mục sản phẩm</span></a></li>
                <li><a asp-controller="Orders" asp-action="Index" class="nav-link @isActive("Orders", "Index")"><i class="fa fa-receipt"></i><span class="ms-1">Đơn hàng</span></a></li>
                <li><a asp-controller="Sales" asp-action="Index" class="nav-link @isActive("Sales", "Index")"><i class="fa fa-cash-register"></i><span class="ms-1">Bán hàng tại quầy</span></a></li>
                <li><a asp-controller="Voucher" asp-action="Index" class="nav-link @isActive("Voucher", "Index")"><i class="fa fa-ticket"></i><span class="ms-1">Mã giảm giá</span></a></li>
                <li><a asp-controller="PaymentMethods" asp-action="Index" class="nav-link @isActive("PaymentMethods", "Index")"><i class="fa fa-credit-card"></i><span class="ms-1">Phương thức thanh toán</span></a></li>
                <li><a asp-controller="Brand" asp-action="Index" class="nav-link @isActive("Brand", "Index")"><i class="fa fa-industry"></i><span class="ms-1">Nhà sản xuất</span></a></li>
                @* <li><a asp-controller="OriginCountry" asp-action="Index" class="nav-link @isActive("OriginCountry", "Index")"><i class="fa fa-globe"></i>Nơi sản xuất</a></li> *@

                @* <li><a asp-controller="NotFound" asp-action="Index" class="nav-link @isActive("NotFound", "Index")"><i class="fa fa-ban"></i>Not found</a></li> *@
            </ul>
            @*       <div class="mt-auto">
                <div class="text-muted small mb-2">More features?</div>
                <a href="#" class="btn btn-outline-primary w-100 mb-2">Upgrade to Pro</a>
            </div> *@
        </nav>
        <!-- Main Content -->
        <div class="flex-grow-1">
            <!-- Topbar -->
            <div class="topbar d-flex justify-content-end align-items-center">
                <a href="/" class="btn btn-sm btn-outline-primary me-3" title="Về trang chủ">
                    <i class="fa fa-home"></i>
                </a>
                @* <div class="me-3">
                    <img src="/images/flag-uk.png" alt="EN" style="height:20px;">
                </div> *@
                @* <div class="me-3 position-relative">
                    <i class="fa fa-bell"></i>
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">2</span>
                </div> *@
                @{
                    var errorMsg = TempData["Error"] as string;
                    var hasAnyMsg = !string.IsNullOrWhiteSpace(errorMsg);
                }
                <div class="dropdown me-3">
                    <button class="btn btn-sm btn-outline-secondary position-relative" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Thông báo">
                        <i class="fa fa-bell"></i>
                        @if (hasAnyMsg)
                        {
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">!</span>
                        }
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end p-0" style="min-width: 320px;">
                        <li class="p-2 border-bottom fw-semibold">Thông báo lỗi</li>
                        @if (hasAnyMsg)
                        {
                            <li><div class="px-3 py-2 small text-danger">@errorMsg</div></li>
                        }
                        else
                        {
                            <li><div class="px-3 py-2 small text-muted">Không có lỗi</div></li>
                        }
                    </ul>
                </div>
                
            </div>
            <!-- Page Content -->
            <main class="content">
                @RenderBody()
            </main>
        </div>
    </div>
    <script>
        (function(){
            var btn = document.getElementById('sidebarToggle');
            var sidebar = document.getElementById('adminSidebar');
            if(!btn || !sidebar) return;
            btn.addEventListener('click', function(){
                sidebar.classList.toggle('collapsed');
            });
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    @RenderSection("Scripts", required: false)
</body>
</html>
